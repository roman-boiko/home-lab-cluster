kind: "DatadogAgent"
apiVersion: "datadoghq.com/v2alpha1"
metadata:
  name: "datadog"
  namespace: "datadog"
spec:
  global:
    site: "datadoghq.com"
    credentials:
      apiSecret:
        secretName: "datadog-secret"
        keyName: "api-key"
    registry: "gcr.io/datadoghq"
    clusterName: "home-lab-cluster"
    tags:
      - "env:home-lab"
  features:
    logCollection:
      enabled: true
      containerCollectAll: true
    npm:
      enabled: true
    liveProcessCollection:
      enabled: true
  override:
    nodeAgent:
      extraConfd:
        configDataMap:
          keycloak.yaml: |-
            ad_identifiers:
              - keycloak
              - jboss-wildfly
            init_config:
            instances:
              # The native keycloak check handles logs, not metrics.
              - tags:
                - "auth:keycloak"
            logs:
              - type: docker
                source: keycloak
                service: keycloak